\begin{lstlisting}[caption=Kode til godkendelse af login, label=AD-AUTH]

var ldap = new LdapConnection(Configuration.LDAPServer) { Credential =  new NetworkCredential(username.Substring(0, username.IndexOf("@")), password) };
try{
    ldap.Bind();
}
catch (COMException){
    return new Person { ID = -1 };
}
catch (Exception e){
    return e.Message.Contains("available") ? new Person { ID = -1 } : null;
}
\end{lstlisting}